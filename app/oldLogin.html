<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>HW Bud</title>
    <style>
      .hide {
        display: none;
       }
    </style>
  </head>

  <body>
    <h2>Login</h2><h2 class = "hide">Signup</h2>
      <div class = "loginSignup">
        <form class = "login">
          Username: <input type = "text" placeholder = "your email" class = "username"/><br>
          Password: <input type = "password" class = "password"/><br>
          <button>Log In!</button><a href = "#"> Don't have an account?</a>
        </form>
        <form class = "signup hide">
          Username: <input type = "text" placeholder = "Your email" class = "username"/><br>
          Password: <input type = "password" class = "password"/><br>
          Password: <input type = "password" class = "password"/><br>
          <button>Sign Up!</button><a href = "#"> Already have an account?</a>
        </form>
        <p class = "message"></p>
     </div>
      <script src = "http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
      <script>
        $(document).ready(function(){
          var url = "http://localhost:8080";
          $('.login').on('click', 'button', function(e){
            e.preventDefault();
            var form = $(this).parent();
            var password = form.find('input.password').val();
            var username = form.find('input.username').val();
            var dataString = JSON.stringify({password: password, username: username});

            if (password.length >= 6  && username.length){

              $.ajax({
                url: url + '/login', 
                method: 'post', 
                data: dataString, 
                success: function(text){
                  $('.message').text(text);
                }, 
                error: function(text){
                  console.log(text)
                  $('.message').text(text);
                }
              })

            } else { 
              if (!username.length) {
                $('.message').text('But...who are you!?');
              } else {
                $('.message').text('Incorrect password. (Hint, all passwords are at least six characters long)');
              }
            }

          });

          $('div.loginSignup').find('form a').on('click', function(e){
            e.preventDefault();
            $('form').toggleClass('hide');
            $('body').find('h2').toggleClass('hide');
          });

          $('.signup').on('click', 'button', function(e){
            e.preventDefault();
            var form = $(this).parent();
            var password = form.find('input.password').val();
            var username = form.find('input.username').val();
            var dataString = JSON.stringify({password: password, username: username});
            if (password.length >= 6  && username.length){

              $.ajax({
                url: url + '/signup', 
                method: 'post', 
                data: dataString, 
                success: function(html){
                  
                }, 
                error: function(text){
                  $('.message').text(text);
                }
              });

            } else {
              if (!username.length) {
                $('.message').text('But...who are you!?');
              } else {
                $('.message').text('Passwords need to be at least 6 characters long');
              }
            }
          });
        });
      </script>

  </body>
</html>